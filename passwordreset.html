<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - VertexCapital</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.0/dist/dotlottie-wc.js" type="module"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            color: #333;
            line-height: 1.6;
            background-color: #fafafa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo img {
            height: 32px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            color: #0c57da;
            margin-left: 10px;
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 30px;
        }

        nav ul li a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav ul li a:hover {
            color: #0e0256;
        }

        .auth-buttons {
            display: flex;
            align-items: center;
        }

        .login-btn {
            background: none;
            border: none;
            color: #333;
            font-weight: 500;
            margin-right: 20px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .login-btn:hover {
            background-color: #f5f5f5;
        }

        .signup-btn {
            background-color: #0c57da;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 24px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .signup-btn:hover {
            background-color: #031330cc;
        }

        /* Reset Password Content */
        .reset-container {
            display: flex;
            min-height: calc(100vh - 80px);
            width: 100%;
        }
        
        /* Animation Section */
        .animation-section {
            flex: 1;
            background: linear-gradient(135deg, #1a2a6c, #0c57da, white);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .animation-wrapper {
            width: 100%;
            max-width: 500px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .animation-content {
            text-align: center;
            color: white;
            margin-top: 20px;
        }
        
        .animation-content h2 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .animation-content p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        /* Form Section */
        .form-section {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            background: white;
        }
        
        .form-wrapper {
            width: 100%;
            max-width: 450px;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .form-logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .form-logo h1 {
            font-size: 2.2rem;
            color: #2c3e50;
            font-weight: 700;
        }
        
        .form-logo span {
            color: #0c57da;
        }
        
        .form-title {
            margin-bottom: 30px;
            text-align: center;
        }
        
        .form-title h2 {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .form-title p {
            color: #7f8c8d;
            font-size: 1rem;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .form-group input {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            border-color: #0c57da;
            outline: none;
            box-shadow: 0 0 0 3px rgba(12, 87, 218, 0.2);
        }
        
        .password-toggle {
            position: absolute;
            right: 12px;
            top: 42px;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: #0c57da;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #031330cc;
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .back-to-login {
            text-align: center;
            margin-top: 25px;
            color: #7f8c8d;
        }
        
        .back-to-login a {
            color: #0c57da;
            text-decoration: none;
            font-weight: 500;
        }
        
        .back-to-login a:hover {
            text-decoration: underline;
        }
        
        .resend-otp {
            text-align: center;
            margin-top: 15px;
            color: #7f8c8d;
        }
        
        .resend-otp a {
            color: #0c57da;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }
        
        .resend-otp a:hover {
            text-decoration: underline;
        }
        
        .resend-otp a:disabled {
            color: #ccc;
            cursor: not-allowed;
        }
        
        .countdown {
            color: #0c57da;
            font-weight: 600;
        }
        
        /* Form Steps */
        .form-step {
            display: none;
        }
        
        .form-step.active {
            display: block;
        }
        
        /* Toastr Customization */
        .toast-success, .toast-info, .toast-warning, .toast-error {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.875rem;
            border-radius: 8px !important;
            background-color: #edf1fd;
            color: #01081e !important;
            border: none !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding-left: 60px !important;
        }
        
        .toast-success {
            border-left: 4px solid #28a745 !important;
        }
        
        .toast-error {
            border-left: 4px solid #dc3545 !important;
        }
        
        .toast-info {
            border-left: 4px solid #17a2b8 !important;
        }
        
        .toast-warning {
            border-left: 4px solid #ffc107 !important;
        }
        
        #toast-container>div {
            background-position: 20px center !important;
            background-size: 24px !important;
        }
        
        #toast-container > .toast-success {
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBmaWxsPSIjMjhhNzQ1Ij48cGF0aCBkPSJNMCAyNTZhMjU2IDI1NiAwIDEgMSA1MTIgMEEyNTYgMjU2IDAgMSAxIDAgMjU2em0zNzAtMTE0LjRjOS42IDguOSA5LjYgMjQuMyAwIDMzLjNsLTE2MCAxNDRjLTkuNiA4LjktMjQuOCA4LjktMzQuNCAwbC04MC03MmMtOS42LTguOS05LjYtMjQuMyAwLTMzLjNzMjQuOC04LjkgMzQuNCAwbDUyLjggNDcuNSAxMjguNC0xMTUuNmM5LjYtOC45IDI0LjgtOC45IDM0LjQgMHoiLz48L3N2Zz4=') !important;
        }

        #toast-container > .toast-info {
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBmaWxsPSIjMTdhMmI4Ij48cGF0aCBkPSJNMjU2IDhDMTE5LjEgOCA4IDExOS4xIDggMjU2czExMS4xIDI0OCAyNDggMjQ4IDI0OC0xMTEuMSAyNDgtMjQ4UzM5Mi45IDggMjU2IDh6bTAgMTEwYzIzLjggMCA0MyAxOS4yIDQzIDQzczAtMTkuMi00My00M2MtMjMuOCAwLTQzIDE5LjItNDMgNDNzMTkuMiA0MyA0MyA0M3ptNDggMjQ2YzAgNDQuMi0zNS44IDgwLTgwIDgwcy04MC0zNS44LTgwLTgwdj0xNDRoMTYwdjQ4YzAgOC44IDcuMiAxNiAxNiAxNmgzMmM4LjggMCAxNi03LjIgMTYtMTZWMjY0YzAtNjEuOS01MC4xLTExMi0xMTItMTEySDIzMmMtOC44IDAtMTYgNy4yLTE2IDE2djMyYzAgOC44IDcuMiAxNiAxNiAxNmg3MmMyNi41IDAgNDggMjEuNSA0OCA0OHYxMDR6Ii8+PC9zdmc+') !important;
        }
        
        #toast-container > .toast-warning {
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBmaWxsPSIjZmZjMTA3Ij48cGF0aCBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptMCA0NDJjLTEwNi45IDAtMTk0LTg3LjEtMTk0LTE5NHM4Ny4xLTE5NCAxOTQtMTk0IDE5NCA4Ny4xIDE5NCAxOTQtODcuMSAxOTQtMTk0IDE5NHptMTYtMjQ2YzAtOC44LTcuMi0xNi0xNi0xNnMtMTYgNy4yLTE2IDE2djE0NGMwIDguOCA3LjIgMTYgMTYgMTZzMTYtNy4yIDE2LTE2VjIwNHptLTE2IDk2Yy0xNy43IDAtMzIgMTQuMy0zMiAzMnMxNC4zIDMyIDMyIDMyIDMyLTE0LjMgMzItMzItMTQuMy0zMi0zMi0zMnoiLz48L3N2Zz4=') !important;
        }
        
        #toast-container > .toast-error {
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBmaWxsPSIjZGMzNTQ1Ij48cGF0aCBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptTEzNi41IDM1OC41YzQuNyA0LjcgNC43IDEyLjMgMCAxN2wtMTcgMTdjLTQuNyA0LjctMTIuMyA0LjctMTcgMGwtMTExLTExMS4xLTExMS4xIDExMS4xYy00LjcgNC43LTEyLjMgNC43LTE3IDBsLTE3LTE3Yy00LjctNC43LTQuNy0xMi4zIDAtMTdMMjA2LjkgMjU2IDk1LjggMTQ0LjljLTQuNy00LjctNC43LTEyLjMgMC0xN2wxNy0xN2M0LjctNC43IDEyLjMtNC43IDE3IDBMMjU2IDIyMi4xbDExMS4xLTExMS4xYzQuNy00LjcgMTIuMy00LjcgMTcgMGwxNyAxN2M0LjcgNC43IDQuNyAxMi4zIDAgMTdMMzA1LjEgMjU2bDExMS40IDExMS41eiIvPjwvc3ZnPg==') !important;
        }
        
        .toast-close-button {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background-color: #ccd7fc !important;
            color: #000617;
            font-weight: bold;
            font-size: 16px;
            opacity: 1;
            text-shadow: none;
        }
        
        .toast-close-button:hover {
            background-color: #b4c4f9 !important;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .reset-container {
                flex-direction: column;
            }
            
            .animation-section {
                display: none;
            }
            
            .form-section {
                padding: 2rem 1.5rem;
            }
        }
        
        @media (max-width: 768px) {
            nav {
                display: none;
            }
        }
        
        @media (max-width: 576px) {
            .form-wrapper {
                padding: 25px 20px;
            }
            
            .form-logo h1 {
                font-size: 1.8rem;
            }
            
            .form-title h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
             <img src="https://res.cloudinary.com/dnjvees9s/image/upload/v1758081509/VertexCapital_updated_gxigji.png" alt="VertexCapital Logo" style="height: 40px;">
             <div class="logo-text">VertexCapital</div>
            </div>
    </header>

    <div class="reset-container">
        <!-- Animation Section (Visible only on desktop) -->
        <div class="animation-section">
            <div>
                <div class="animation-wrapper">
                    <dotlottie-wc 
                        src="https://lottie.host/ac4ffa5f-dbf8-473b-a1f3-99948dd56af7/qduEDEaZfn.lottie" 
                        style="width: 100%; height: 300px" 
                        speed="1" 
                        autoplay 
                        loop>
                    </dotlottie-wc>
                </div>
                <div class="animation-content">
                    <h2>Secure Password Reset</h2>
                    <p>Regain access to your VertexCapital account securely</p>
                </div>
            </div>
        </div>

        <script>
            // Dark theme time: 6pm (18) to 6am (6)
            function isDarkTime() {
            const hour = new Date().getHours();
            return (hour >= 18 || hour < 6);
            }

            function setTheme(dark, themePreviewIcon, themeIcon) {
            if (dark) {
                document.body.classList.add('dark-theme');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
                themePreviewIcon.title = "Switch to light theme";
            } else {
                document.body.classList.remove('dark-theme');
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
                themePreviewIcon.title = "Switch to dark theme";
            }
            }

            document.addEventListener('DOMContentLoaded', function() {
            const themePreviewIcon = document.querySelector('.theme-preview-icon');
            const themeIcon = themePreviewIcon.querySelector('i');
            // Set theme on load
            const dark = isDarkTime();
            setTheme(dark, themePreviewIcon, themeIcon);

            // Theme preview icon toggle
            themePreviewIcon.addEventListener('click', function() {
                const isDark = document.body.classList.contains('dark-theme');
                setTheme(!isDark, themePreviewIcon, themeIcon);
            });
            });
        </script>
        <style>
            body.dark-theme {
            background: #101624;
            color: #e3e6ee;
            }
            body.dark-theme header {
            background: #181f2e;
            box-shadow: 0 2px 10px rgba(0,0,0,0.4);
            }
            body.dark-theme .logo-text {
            color: #0c57da;
            }
            body.dark-theme nav ul li a {
            color: #e3e6ee;
            }
            body.dark-theme nav ul li a:hover {
            color: #0c57da;
            }
            body.dark-theme .login-btn {
            color: #e3e6ee;
            background: #232b3d;
            }
            body.dark-theme .login-btn:hover {
            background: #232b3d;
            }
            body.dark-theme .signup-btn {
            background: #0c57da;
            color: #fff;
            }
            body.dark-theme .signup-btn:hover {
            background: #0c57da;
            }
            body.dark-theme .reset-container {
            background: #101624;
            }
            body.dark-theme .animation-section {
            background: linear-gradient(135deg, #0c1a36, #0c57da, #232b3d);
            }
            body.dark-theme .animation-wrapper {
            background: rgba(24, 31, 46, 0.7);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            }
            body.dark-theme .animation-content {
            color: #e3e6ee;
            }
            body.dark-theme .form-section {
            background: #181f2e;
            }
            body.dark-theme .form-wrapper {
            background: #181f2e;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            }
            body.dark-theme .form-logo h1 {
            color: #e3e6ee;
            }
            body.dark-theme .form-logo span {
            color: #0c57da;
            }
            body.dark-theme .form-title h2 {
            color: #e3e6ee;
            }
            body.dark-theme .form-title p,
            body.dark-theme .back-to-login,
            body.dark-theme .resend-otp {
            color: #b3b9c9;
            }
            body.dark-theme .form-group label {
            color: #e3e6ee;
            }
            body.dark-theme .form-group input {
            background: #232b3d;
            color: #e3e6ee;
            border: 1px solid #2c3650;
            }
            body.dark-theme .form-group input:focus {
            border-color: #0c57da;
            box-shadow: 0 0 0 3px rgba(12,87,218,0.15);
            }
            body.dark-theme .password-toggle {
            color: #b3b9c9;
            }
            body.dark-theme .btn {
            background: #0c57da;
            color: #fff;
            }
            body.dark-theme .btn:hover {
            background: #0c57da;
            }
            body.dark-theme .btn:disabled {
            background: #2c3650;
            color: #b3b9c9;
            }
            body.dark-theme .back-to-login a,
            body.dark-theme .resend-otp a {
            color: #0c57da;
            }
            body.dark-theme .back-to-login a:hover,
            body.dark-theme .resend-otp a:hover {
            color: #0c57da;
            }
            body.dark-theme .countdown {
            color: #0c57da;
            }
            /* Toastr dark theme */
            body.dark-theme #toast-container>div {
            background-color: #232b3d !important;
            color: #e3e6ee !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            }
            body.dark-theme .toast-close-button {
            background: #2c3650 !important;
            color: #e3e6ee;
            }
            body.dark-theme .toast-close-button:hover {
            background: #0c57da !important;
            }
            /* Preview icon style */
            .theme-preview-icon {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 9999;
            background: #fff;
            color: #0c57da;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.18);
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.7rem;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
            }
            body.dark-theme .theme-preview-icon {
            background: #232b3d;
            color: #0c57da;
            }
        </style>
        </style>
        <!-- Theme preview icon -->
        <div class="theme-preview-icon" title="Theme preview">
            <i class="fas fa-moon"></i>
        </div>
        
        <!-- Form Section -->
        <div class="form-section">
            <div class="form-wrapper">
                <div class="form-logo">
                    <h1>Vertex<span>Capital</span></h1>
                </div>
                
                <!-- Step 1: Request OTP -->
                <div class="form-step active" id="step1">
                    <div class="form-title">
                        <h2>Reset Your Password</h2>
                        <p>Enter your email to receive a password reset OTP</p>
                    </div>
                    
                    <form id="requestOtpForm">
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" placeholder="Enter your email address" required>
                        </div>
                        
                        <button type="submit" class="btn" id="requestOtpBtn">Send Reset OTP</button>
                    </form>
                    
                    <div class="back-to-login">
                        <p>Remember your password? <a href="loginsignup.html">Back to Login</a></p>
                    </div>
                </div>
                
                <!-- Step 2: Verify OTP and Set New Password -->
                <div class="form-step" id="step2">
                    <div class="form-title">
                        <h2>Create New Password</h2>
                        <p>Enter the OTP sent to your email and your new password</p>
                    </div>
                    
                    <form id="resetPasswordForm">
                        <div class="form-group">
                            <label for="otp">Verification Code</label>
                            <input type="text" id="otp" name="otp" placeholder="Enter 6-digit OTP" required maxlength="6">
                        </div>
                        
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" name="newPassword" placeholder="Enter your new password" required>
                            <span class="password-toggle" id="toggleNewPassword">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm your new password" required>
                            <span class="password-toggle" id="toggleConfirmPassword">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                        
                        <button type="submit" class="btn" id="resetPasswordBtn">Reset Password</button>
                    </form>
                    
                    <div class="resend-otp">
                        <p>Didn't receive the code? <a href="#" id="resendOtpLink">Resend OTP</a> <span id="countdown" class="countdown"></span></p>
                    </div>
                    
                    <div class="back-to-login">
                        <p>Remember your password? <a href="loginsignup.html">Back to Login</a></p>
                    </div>
                </div>
                
                <!-- Step 3: Success Message -->
                <div class="form-step" id="step3">
                    <div class="form-title">
                        <h2>Password Reset Successful</h2>
                        <p>Your password has been reset successfully</p>
                    </div>
                    
                    <div style="text-align: center; margin: 30px 0;">
                        <i class="fas fa-check-circle" style="font-size: 60px; color: #28a745;"></i>
                    </div>
                    
                    <div class="back-to-login">
                        <p>You can now <a href="loginsignup.html">login with your new password</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Toastr configuration
        toastr.options = {
            'closeButton': true,
            'debug': false,
            'newestOnTop': true,
            'progressBar': false,
            'positionClass': 'toast-top-right',
            'preventDuplicates': false,
            'showDuration': '1000',
            'hideDuration': '1000',
            'timeOut': '5000',
            'extendedTimeOut': '1000',
            'showEasing': 'swing',
            'hideEasing': 'linear',
            'showMethod': 'fadeIn',
            'hideMethod': 'fadeOut'
        };

        // Global variables
        let userEmail = '';
        let resendTimer;
        let resendTimeLeft = 60;

        // DOM elements
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const requestOtpForm = document.getElementById('requestOtpForm');
        const resetPasswordForm = document.getElementById('resetPasswordForm');
        const resendOtpLink = document.getElementById('resendOtpLink');
        const countdown = document.getElementById('countdown');
        const requestOtpBtn = document.getElementById('requestOtpBtn');
        const resetPasswordBtn = document.getElementById('resetPasswordBtn');
        const toggleNewPassword = document.getElementById('toggleNewPassword');
        const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');

        // Show a specific step
        function showStep(stepNumber) {
            step1.classList.remove('active');
            step2.classList.remove('active');
            step3.classList.remove('active');
            
            if (stepNumber === 1) step1.classList.add('active');
            if (stepNumber === 2) step2.classList.add('active');
            if (stepNumber === 3) step3.classList.add('active');
        }

        // Start the resend OTP countdown
        function startResendCountdown() {
            resendOtpLink.style.pointerEvents = 'none';
            resendOtpLink.style.color = '#ccc';
            countdown.textContent = `(wait ${resendTimeLeft}s)`;
            
            resendTimer = setInterval(() => {
                resendTimeLeft--;
                countdown.textContent = `(wait ${resendTimeLeft}s)`;
                
                if (resendTimeLeft <= 0) {
                    clearInterval(resendTimer);
                    resendOtpLink.style.pointerEvents = 'auto';
                    resendOtpLink.style.color = '#0c57da';
                    countdown.textContent = '';
                    resendTimeLeft = 60;
                }
            }, 1000);
        }

        // Toggle password visibility
        toggleNewPassword.addEventListener('click', function() {
            const passwordInput = document.getElementById('newPassword');
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.querySelector('i').classList.toggle('fa-eye');
            this.querySelector('i').classList.toggle('fa-eye-slash');
        });

        toggleConfirmPassword.addEventListener('click', function() {
            const passwordInput = document.getElementById('confirmPassword');
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.querySelector('i').classList.toggle('fa-eye');
            this.querySelector('i').classList.toggle('fa-eye-slash');
        });

        // Request OTP form submission
        requestOtpForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            
            // Basic email validation
            if (!email || !email.includes('@')) {
                toastr.error('Please enter a valid email address', 'Error');
                return;
            }
            
            try {
                // Show loading state
                requestOtpBtn.textContent = 'Sending...';
                requestOtpBtn.disabled = true;
                
                // Make API request to your backend
                const response = await fetch('https://vertexcapital.onrender.com/api/users/request-password-reset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    userEmail = email;
                    toastr.success('OTP sent to your email. Please check your inbox.', 'Success');
                    showStep(2);
                    startResendCountdown();
                } else {
                    toastr.error(data.message || 'Failed to send OTP. Please try again.', 'Error');
                }
            } catch (error) {
                console.error('Error:', error);
                toastr.error('Network error. Please check your connection and try again.', 'Error');
            } finally {
                // Reset button state
                requestOtpBtn.textContent = 'Send Reset OTP';
                requestOtpBtn.disabled = false;
            }
        });

        // Resend OTP handler
        resendOtpLink.addEventListener('click', async function(e) {
            e.preventDefault();
            
            if (resendTimeLeft < 60) return; // Prevent multiple clicks
            
            try {
                // Show loading state
                resendOtpLink.innerHTML = 'Resending...';
                
                // Make API request to your backend
                const response = await fetch('https://vertexcapital.onrender.com/api/users/request-password-reset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email: userEmail })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    toastr.success('New OTP sent to your email.', 'Success');
                    startResendCountdown();
                } else {
                    toastr.error(data.message || 'Failed to resend OTP. Please try again.', 'Error');
                }
            } catch (error) {
                console.error('Error:', error);
                toastr.error('Network error. Please check your connection and try again.', 'Error');
            } finally {
                // Reset link state
                resendOtpLink.innerHTML = 'Resend OTP';
            }
        });

        // Reset password form submission
        resetPasswordForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const otp = document.getElementById('otp').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validation
            if (!otp || otp.length !== 6) {
                toastr.error('Please enter a valid 6-digit OTP', 'Error');
                return;
            }
            
            if (!newPassword || newPassword.length < 6) {
                toastr.error('Password must be at least 6 characters long', 'Error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                toastr.error('Passwords do not match', 'Error');
                return;
            }
            
            try {
                // Show loading state
                resetPasswordBtn.textContent = 'Resetting...';
                resetPasswordBtn.disabled = true;
                
                // Make API request to your backend
                const response = await fetch('https://vertexcapital.onrender.com/api/users/reset-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        email: userEmail, 
                        otp, 
                        newPassword 
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    toastr.success('Password reset successfully. You can now login with your new password.', 'Success');
                    showStep(3);
                    clearInterval(resendTimer);
                } else {
                    toastr.error(data.message || 'Failed to reset password. Please try again.', 'Error');
                }
            } catch (error) {
                console.error('Error:', error);
                toastr.error('Network error. Please check your connection and try again.', 'Error');
            } finally {
                // Reset button state
                resetPasswordBtn.textContent = 'Reset Password';
                resetPasswordBtn.disabled = false;
            }
        });
    </script>
</body>
</html>